# step_modules ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ (2025å¹´6æœˆ13æ—¥)

## ğŸ§¹ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿæ–½æ¦‚è¦

### å‰Šé™¤å‰ã®çŠ¶æ³
- **ãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 19å€‹ (å¤šæ•°ã®é‡è¤‡ãƒ»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«å«ã‚€)
- **çŠ¶æ…‹**: ä¹±ç«‹çŠ¶æ…‹ã§é–‹ç™ºç’°å¢ƒãŒæ±šæŸ“ã•ã‚Œã¦ã„ãŸ

### å‰Šé™¤å¾Œã®çŠ¶æ³  
- **ãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 7å€‹ (å¿…è¦æœ€å°é™ã«æ•´ç†)
- **çŠ¶æ…‹**: å„ã‚¹ãƒ†ãƒƒãƒ—ã®ç¾è¡Œãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã¿ãŒæ®‹å­˜

## ğŸ—‚ï¸ æœ€çµ‚çš„ãªstep_modulesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
/app/step_modules/
â”œâ”€â”€ __init__.py                               # Pythonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åˆæœŸåŒ–
â”œâ”€â”€ step0_asset_preservation.py               # Step0: ã‚¢ã‚»ãƒƒãƒˆä¿å­˜ (11.7KB)
â”œâ”€â”€ step1_extract.py                          # Step1: ãƒ¡ãƒƒã‚·ãƒ¥æŠ½å‡º (17.3KB)  
â”œâ”€â”€ step2_skeleton.py                         # Step2: ã‚¹ã‚±ãƒ«ãƒˆãƒ³ç”Ÿæˆ (32.9KB)
â”œâ”€â”€ step3_skinning_unirig.py                  # Step3: ã‚¹ã‚­ãƒ‹ãƒ³ã‚°é©ç”¨ (12.9KB)
â”œâ”€â”€ step4_merge.py                            # Step4: ãƒãƒ¼ã‚¸å‡¦ç† (16.4KB)
â””â”€â”€ step5_reliable_uv_material_transfer.py    # Step5: UVãƒ»ãƒãƒ†ãƒªã‚¢ãƒ«è»¢é€ (15.2KB) [VRMå¯¾å¿œ]
```

## ğŸ—‘ï¸ å‰Šé™¤ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

### Step0é–¢é€£ã®å‰Šé™¤ãƒ•ã‚¡ã‚¤ãƒ«
- `step0_asset_preservation.py.backup_before_simplification`
- `step0_asset_preservation_fixed.py`
- `step0_asset_preservation_new.py`

### Step1é–¢é€£ã®å‰Šé™¤ãƒ•ã‚¡ã‚¤ãƒ«  
- `step1_extract copy.py`

### Step2é–¢é€£ã®å‰Šé™¤ãƒ•ã‚¡ã‚¤ãƒ«
- `step2_skeleton.py.broken`

### Step4é–¢é€£ã®å‰Šé™¤ãƒ•ã‚¡ã‚¤ãƒ«
- `step4_merge.py.backup_before_merge_specialization`

### Step5é–¢é€£ã®å‰Šé™¤ãƒ•ã‚¡ã‚¤ãƒ« (6å€‹)
- `step5_blender_integration.py` (å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³)
- `step5_blender_integration.py.backup_with_errors`
- `step5_blender_integration_enhanced.py` (æ—§ç‰ˆ)
- `step5_blender_integration_robust.py` (æ—§ç‰ˆ)
- `step5_blender_integration_robust.py.backup`
- `step5_simplified_blender_integration.py` (æ—§ç‰ˆ)

### ãã®ä»–å‰Šé™¤ãƒ•ã‚¡ã‚¤ãƒ«
- `__pycache__/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (Pythonãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥)

## âœ… app.py ã¨ã®æ•´åˆæ€§ç¢ºèª

### ç¾åœ¨ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ–‡
```python
from step_modules.step0_asset_preservation import Step0AssetPreservation
from step_modules.step1_extract import Step1Extract
from step_modules.step2_skeleton import Step2Skeleton
from step_modules.step3_skinning_unirig import Step3UniRigSkinning
from step_modules.step4_merge import Step4CrossPlatformMerge
from step_modules.step5_reliable_uv_material_transfer import Step5ReliableUVMaterialTransfer
```

### æ•´åˆæ€§ç¢ºèªçµæœ
- âœ… ã™ã¹ã¦ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒæ­£å¸¸ã«è§£æ±ºã•ã‚Œã‚‹
- âœ… ã‚¨ãƒ©ãƒ¼æ¤œå‡ºãªã—
- âœ… å„ã‚¹ãƒ†ãƒƒãƒ—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒæ­£ã—ãé…ç½®ã•ã‚Œã¦ã„ã‚‹

## ğŸ“‹ å„ã‚¹ãƒ†ãƒƒãƒ—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è²¬å‹™ã¨ç¾çŠ¶

### Step0: Asset Preservation (ã‚¢ã‚»ãƒƒãƒˆä¿å­˜)
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `step0_asset_preservation.py` (11.7KB)
- **è²¬å‹™**: UVã€ãƒãƒ†ãƒªã‚¢ãƒ«ã€ãƒ†ã‚¯ã‚¹ãƒãƒ£æƒ…å ±ã®è©³ç´°ä¿å­˜
- **å‡ºåŠ›**: ã‚¢ã‚»ãƒƒãƒˆãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿JSONã€ãƒ†ã‚¯ã‚¹ãƒãƒ£ãƒ•ã‚¡ã‚¤ãƒ«ç¾¤
- **çŠ¶æ…‹**: âœ… ç¾è¡Œãƒãƒ¼ã‚¸ãƒ§ãƒ³

### Step1: Extract (ãƒ¡ãƒƒã‚·ãƒ¥æŠ½å‡º)
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `step1_extract.py` (17.3KB)
- **è²¬å‹™**: 3Dãƒ¢ãƒ‡ãƒ«ã‹ã‚‰ãƒ¡ãƒƒã‚·ãƒ¥ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º
- **å‡ºåŠ›**: `raw_data.npz` (å›ºå®šå)
- **çŠ¶æ…‹**: âœ… ç¾è¡Œãƒãƒ¼ã‚¸ãƒ§ãƒ³

### Step2: Skeleton (ã‚¹ã‚±ãƒ«ãƒˆãƒ³ç”Ÿæˆ)
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `step2_skeleton.py` (32.9KB)
- **è²¬å‹™**: AIã«ã‚ˆã‚‹ã‚¹ã‚±ãƒ«ãƒˆãƒ³æ§‹é€ ã®ç”Ÿæˆ
- **å‡ºåŠ›**: `{model_name}.fbx`, `predict_skeleton.npz`
- **çŠ¶æ…‹**: âœ… ç¾è¡Œãƒãƒ¼ã‚¸ãƒ§ãƒ³

### Step3: Skinning (ã‚¹ã‚­ãƒ‹ãƒ³ã‚°é©ç”¨)
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `step3_skinning_unirig.py` (12.9KB)
- **è²¬å‹™**: ãƒ¡ãƒƒã‚·ãƒ¥ã¨ã‚¹ã‚±ãƒ«ãƒˆãƒ³ã®ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°
- **å‡ºåŠ›**: `{model_name}_skinned_unirig.fbx`
- **çŠ¶æ…‹**: âœ… åŸæµå‡¦ç†çµ±åˆå®Œäº†æ¸ˆã¿

### Step4: Merge (ãƒãƒ¼ã‚¸å‡¦ç†)
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `step4_merge.py` (16.4KB)
- **è²¬å‹™**: ã‚¹ã‚±ãƒ«ãƒˆãƒ³ã¨ã‚¹ã‚­ãƒ³ã‚¦ã‚§ã‚¤ãƒˆã®ãƒãƒ¼ã‚¸
- **å‡ºåŠ›**: `{model_name}_merged.fbx`
- **çŠ¶æ…‹**: âœ… ç¾è¡Œãƒãƒ¼ã‚¸ãƒ§ãƒ³

### Step5: UV Material Transfer (UVãƒ»ãƒãƒ†ãƒªã‚¢ãƒ«è»¢é€)
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `step5_reliable_uv_material_transfer.py` (15.2KB)
- **è²¬å‹™**: UVãƒ»ãƒãƒ†ãƒªã‚¢ãƒ«ãƒ»ãƒ†ã‚¯ã‚¹ãƒãƒ£ã®ç¢ºå®Ÿãªè»¢é€
- **å¯¾å¿œå½¢å¼**: .glb, .gltf, .fbx, .obj, .vrm 
- **å‡ºåŠ›**: `{model_name}_final.fbx`
- **çŠ¶æ…‹**: âœ… VRMå¯¾å¿œå®Œäº†æ¸ˆã¿

## ğŸ¯ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã®åŠ¹æœ

### é–‹ç™ºç’°å¢ƒã®æ”¹å–„
- **ãƒ•ã‚¡ã‚¤ãƒ«æ•°å‰Šæ¸›**: 19å€‹ â†’ 7å€‹ (63%å‰Šæ¸›)
- **æ··ä¹±ã®è§£æ¶ˆ**: é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚‹æ··ä¹±ã‚’æ’é™¤
- **ä¿å®ˆæ€§å‘ä¸Š**: å„ã‚¹ãƒ†ãƒƒãƒ—ã®ç¾è¡Œãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæ˜ç¢º

### æŠ€è¡“çš„ãƒ¡ãƒªãƒƒãƒˆ
- **æ˜ç¢ºãªè²¬å‹™åˆ†é›¢**: å„ã‚¹ãƒ†ãƒƒãƒ—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å½¹å‰²ãŒæ˜ç¢º
- **ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼å›é¿**: ä¸è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚‹ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ··ä¹±ã‚’é˜²æ­¢
- **ãƒ‡ãƒãƒƒã‚°åŠ¹ç‡åŒ–**: å•é¡Œç™ºç”Ÿæ™‚ã®å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ç‰¹å®šãŒå®¹æ˜“

### ä»Šå¾Œã®é–‹ç™ºæŒ‡é‡
- **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¦æ­¢**: `.backup`æ‹¡å¼µå­ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆç¦æ­¢
- **é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ç¦æ­¢**: `copy`ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆç¦æ­¢
- **å³åº§å‰Šé™¤**: ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒãƒƒã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®å³åº§å‰Šé™¤å®Ÿè¡Œ

## ğŸš¨ ç¶­æŒç®¡ç†æŒ‡é‡

### ãƒ•ã‚¡ã‚¤ãƒ«å‘½åè¦å‰‡ã®å³å®ˆ
```python
# âœ… æ¨å¥¨: æ­£è¦ã®ã‚¹ãƒ†ãƒƒãƒ—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å
step{N}_{function_name}.py

# âŒ ç¦æ­¢: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»ã‚³ãƒ”ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«
step{N}_{function_name}.py.backup
step{N}_{function_name} copy.py
step{N}_{function_name}_fixed.py
```

### ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- [ ] é–‹ç™ºä½œæ¥­çµ‚äº†æ™‚ã®ä¸è¦ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
- [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®å³åº§å‰Šé™¤
- [ ] `__pycache__`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å®šæœŸå‰Šé™¤
- [ ] ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæ¥­çµ‚äº†æ™‚å‰Šé™¤

### å®šæœŸçš„ãªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
```bash
# æ¨å¥¨: å®šæœŸå®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰
cd /app/step_modules
rm -f *.backup* *.copy* *_fixed.py *_new.py *_old.py
rm -rf __pycache__
```

---

## ğŸ“Š çµ±è¨ˆæƒ…å ±

### ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºåˆ†å¸ƒ
```
step0_asset_preservation.py:           11.7KB
step1_extract.py:                      17.3KB
step2_skeleton.py:                     32.9KB (æœ€å¤§)
step3_skinning_unirig.py:              12.9KB
step4_merge.py:                        16.4KB
step5_reliable_uv_material_transfer.py: 15.2KB
åˆè¨ˆ:                                  106.4KB
```

### ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å‰å¾Œã®æ¯”è¼ƒ
- **å‰Šé™¤ãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 12å€‹
- **ä¿æŒãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 7å€‹ (ç¾è¡Œãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã¿)
- **ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡å‰Šæ¸›**: æ¨å®š50KBä»¥ä¸Š

---

**ğŸ“… ä½œæˆæ—¥**: 2025å¹´6æœˆ13æ—¥  
**ğŸ¯ å¯¾è±¡**: é–‹ç™ºç’°å¢ƒæ•´ç†å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ  
**âœ… ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: step_modulesã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†  
**ğŸ“‹ åŠ¹æœ**: é–‹ç™ºç’°å¢ƒã®æ¸…æ½”æ€§ç¢ºä¿ãƒ»ä¿å®ˆæ€§å‘ä¸Šãƒ»æ··ä¹±è§£æ¶ˆ
